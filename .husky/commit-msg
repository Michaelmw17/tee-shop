# Check for potentially sensitive information in commit message
commit_msg=$(cat "$1")

# Patterns to check for sensitive data
patterns=(
  "password"
  "secret"
  "key.*="
  "token"
  "api[_-]?key"
  "auth"
  "credentials"
)

echo "ğŸ” Scanning commit message for sensitive information..."

for pattern in "${patterns[@]}"; do
  if echo "$commit_msg" | grep -i -q "$pattern"; then
    echo "âš ï¸  WARNING: Commit message contains potentially sensitive keyword: '$pattern'"
    echo "ğŸ“ Commit message: $commit_msg"
    echo "â“ Are you sure you want to commit this? (y/N)"
    read -r response
    if [ "$response" != "y" ] && [ "$response" != "Y" ]; then
      echo "âŒ Commit aborted for security reasons."
      exit 1
    fi
  fi
done

echo "âœ… Commit message security check passed!"